---
title: A quick introduction to FLR
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
github_document:
  mathjax: TRUE
tags: FLR FLCore introduction
license: Creative Commons CC-BY SA
---
 
```{r, ini, echo=FALSE, results='hide', message=FALSE}
library(knitr)
opts_chunk$set(fig.align='center',
  message=FALSE, warning=FALSE, echo=TRUE, cache=FALSE)
options(width=50)
set.seed(1423)
```

The Fisheries Library in R (FLR) is a collection of tools for quantitative fisheries science, developed in the R language, that facilitates the construction of bio-economic simulation models of fisheries systems.

FLR builds on the powerful R environment and syntax to create a [domain-specific language](https://en.wikipedia.org/wiki/Domain-specific_language) for the quantitative analysis of the expected risks and effects of fisheries management decisions. The classes and methods in FLR consider uncertainty an integral part of our knowledge of fisheries system. [...]

## Required packages

To follow this tutorial you should have installed the following packages:

- FLR: [FLCore](http://www.flr-project.org/FLCore/)
- FLR: [FLCore](http://www.flr-project.org/FLCore/)

You can do so as follows,

```{r, eval=FALSE}
install.packages(c("FLCore"), repos="http://flr-project.org/R")
```

# Starting with FLCore

The main *classes* (i.e. data structures) and methods (i.e. procedures) in the FLR system are found in the `FLCore` package. Let's load it first

```{r, pkgs}
library(FLCore)
```

so can then inspect an example object

```{r, ple4}
data(ple4)
```

The `ple4` object is of class `FLStock`, used in **FLR** to represent the representation of the fish population that is constructed from catch and abundance data through an stock assesssment. `FLStock` is an S4 class (see `?Classes_Details` for futher details on S4 classes), consisting of a number of slots able to hold data or results for each of the elements in it. By calling the `summary` method on the object

```{r, summaryple4}
summary(ple4)
```

we can inspect the slots, dimensions and structure. Most slots in the class (e.g. `catch` or `stock.n`) of themselves of another **FLCore** class, `FLQuant`. This class, the basic element used to assemble all other classes in **FLR**, is an 6-dimensional array that can take advantange of the powerful array algebra capabilities of R. All slots can be accessed and modified using accessors and replacement methods

```{r, accessors}
catch(ple4)

m(ple4) <- m(ple4) + m(ple4) * 0.5
```

Other standard R methods have also been defined for these classes in a way that is as intuitive as possible for any R user. For example, subsetting using the `[` operator works on both `FLStock`

```{r, subsetFLStock}
summary(ple4[, 1:10])
```

and `FLQuant`

```{r, subsetFLQuant}
stock.n(ple4)[1,]
```

while ensuring that the result are always valid object of the same class. For example, selecting a single element along the first dimension (`age`) did not drop that dimension from the object, in contrast with the standard behaviour in R for `array`.

Similarly to the `summary` method above, a common set of methofd exist for each class to create new objects,

```{r, creator}
FLQuant(rlnorm(30), dimnames=list(age=0:5, year=2012:2017))
```

coerce to and from other classes,

```{r, as.df}
head(as.data.frame(ple4))
```

or plot an object

```{r, plotFLStock}
plot(ple4)
```

A number of fisheries specific calculations are also available. For example, the estimated spawning stock biomass (SSB), can be obtained from an `FLStock` object using

```{r, ssb}
ssb(ple4)
```

or the mean fishing mortality accross the fully-selected ages ($\bar{F}$) with

```{r, fbar}
fbar(ple4)
```



# References

L. T. Kell, I. Mosqueira, P. Grosjean, J-M. Fromentin, D. Garcia, R. Hillary, E. Jardim, S. Mardle, M. A. Pastoors, J. J. Poos, F. Scott, R. D. Scott; FLR: an open-source framework for the evaluation and development of management strategies. *ICES J Mar Sci* 2007; 64 (4): 640-646. doi: [10.1093/icesjms/fsm012](https://doi.org/10.1093/icesjms/fsm012)

# More information

* You can submit bug reports, questions or suggestions on this tutorial at <https://github.com/flr/doc/issues>.
* Or send a pull request to <https://github.com/flr/doc/>
* For more information on the FLR Project for Quantitative Fisheries Science in R, visit the FLR webpage, <http://flr-project.org>.

## Software Versions

* `r version$version.string`
* FLCore: `r packageVersion('FLCore')`
* **Compiled**: `r date()`

## License

This document is licensed under the [Creative Commons Attribution-ShareAlike 4.0 International](https://creativecommons.org/licenses/by-sa/4.0) license.

## Author information

**Iago MOSQUEIRA**. European Commission Joint Research Centre (JRC), Institute for the Protection and Security of the Citizen (IPSC), Maritime Affairs Unit, Via E. Fermi 2749, 21027 Ispra VA, Italy. <https://ec.europa.eu/jrc/>
