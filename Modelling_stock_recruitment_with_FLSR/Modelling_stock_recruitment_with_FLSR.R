## ----pkgs----------------------------------------------------------------
library(FLCore)

## ----data----------------------------------------------------------------
data(ple4)

## ------------------------------------------------------------------------
rec(ple4)

ssb(ple4)

## ------------------------------------------------------------------------
p4sr <- as.FLSR(ple4)

summary(p4sr)

## ------------------------------------------------------------------------
rec(p4sr)

ssb(p4sr)

## ------------------------------------------------------------------------
plot(ssb(p4sr), rec(p4sr))

## ------------------------------------------------------------------------
model(p4sr) <- ricker()

## ------------------------------------------------------------------------
model(p4sr)

## ------------------------------------------------------------------------
logl(p4sr)

## ------------------------------------------------------------------------
initial(p4sr)

## ------------------------------------------------------------------------
params(p4sr)

## ------------------------------------------------------------------------
p4sr <- fmle(p4sr)

## ------------------------------------------------------------------------
summary(p4sr)

## ------------------------------------------------------------------------
plot(p4sr)

## ------------------------------------------------------------------------
p4sr <- fmle(p4sr, method='L-BFGS-B')

## ------------------------------------------------------------------------
data(nsher)

## ------------------------------------------------------------------------
plot(ssb(nsher), rec(nsher))

## ------------------------------------------------------------------------
bevholt()

shepherd()

cushing()

geomean()

segreg()

rickerSV()

bevholtSV()

shepherdSV()

bevholtAR1()

## ------------------------------------------------------------------------
model(nsher) <- 'ricker'

nhri <- fmle(nsher)

## ------------------------------------------------------------------------
model(nsher) <- 'bevholt'

nhbh <- fmle(nsher)

## ------------------------------------------------------------------------
plot(nhri)

plot(nhbh)

## ------------------------------------------------------------------------
AIC(nhri)

AIC(nhbh)

## ------------------------------------------------------------------------
BIC(nhri)

BIC(nhbh)


## ------------------------------------------------------------------------
predict(nhri, ssb=FLQuant(seq(185, 500, length=10)))

## ------------------------------------------------------------------------
profile(nhri)

profile(p4sr)

## ------------------------------------------------------------------------
model(p4sr) <- bevholtSV

p4sr <- fmle(p4sr, fixed = list(s = 0.8))

## ------------------------------------------------------------------------
plot(p4sr)

## ------------------------------------------------------------------------
params(p4sr)

## ------------------------------------------------------------------------
vcov(nhri)

## ------------------------------------------------------------------------
cov2cor(vcov(nhri)[,,1])

## ------------------------------------------------------------------------
niter <- 10

model(p4sr) <- bevholt

p4sr <- fmle(p4sr)

res.boot <- sample(c(residuals(p4sr)), niter * dims(p4sr)$year, replace=T)

p4sb <- propagate(p4sr, niter)

rec(p4sb) <- rec(p4sb) * exp(res.boot)

p4sb <- fmle(p4sb)

params(p4sb)

## ------------------------------------------------------------------------
plot(rec(p4sb))

plot(fitted(p4sb))


