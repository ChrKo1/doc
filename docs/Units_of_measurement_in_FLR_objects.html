<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Units of measurement in FLR objects</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="http://flr-project.org">
    <span class="fa fa-home"></span>
     
    FLR
  </a>
</li>
<li>
  <a href="index.html">
    <span class="fa fa-info"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-gear"></span>
     
    Introduction
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="A_quick_introduction_to_FLR.html">A quick intro</a>
    </li>
    <li>
      <a href="B.html">Page B</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-gear"></span>
     
    Input
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="A.html">Page A</a>
    </li>
    <li>
      <a href="B.html">Page B</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-gear"></span>
     
    Visualization
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="A.html">Page A</a>
    </li>
    <li>
      <a href="B.html">Page B</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-gear"></span>
     
    Modelling
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="A.html">Page A</a>
    </li>
    <li>
      <a href="B.html">Page B</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-gear"></span>
     
    Advice
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="A.html">Page A</a>
    </li>
    <li>
      <a href="B.html">Page B</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-gear"></span>
     
    MSE
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="A.html">Page A</a>
    </li>
    <li>
      <a href="B.html">Page B</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://example.com">
    <span class="fa fa-question fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Units of measurement in FLR objects</h1>
<h4 class="date"><em>11 August, 2017</em></h4>

</div>


<p>The S4 classes defined in the <strong>FLCore</strong> package offer certain facilities for dealing with units of measurement when managing and operating with data and results. The mechanism is relatively simple, tailored to the usual quantities used in fisheries science, and attempts to only to simplify keeping track of the units in the data. No transformation of values takes place, in contrast with the functions offered by other R packages, like <a href="https://cran.r-project.org/package=units">units</a>.</p>
<div id="required-packages" class="section level2">
<h2>Required packages</h2>
<p>To follow this tutorial you should have installed the following packages:</p>
<ul>
<li>FLR: <a href="http://www.flr-project.org/FLCore/">FLCore</a></li>
</ul>
<p>You can do so as follows:</p>
<pre class="r"><code>install.packages(c(&quot;FLCore&quot;), repos=&quot;http://flr-project.org/R&quot;)</code></pre>
<pre class="r"><code>library(FLCore)</code></pre>
</div>
<div id="storing-units-of-measurement" class="section level1">
<h1>Storing units of measurement</h1>
<p>Units of measurements can be specified in the <code>units</code> slot of the <code>FLQuant</code> and <code>FLCohort</code> classes, as a character vector of length 1</p>
<pre class="r"><code>fq &lt;- FLQuant(1.287, units=&quot;kg&quot;)
print(fq)</code></pre>
<pre><code>An object of class &quot;FLQuant&quot;
, , unit = unique, season = all, area = unique

     year
quant 1    
  all 1.287

units:  kg </code></pre>
<p>and for the <code>FLPar</code> class as a vector of length equal to the number of parameters (<code>params</code>)</p>
<pre class="r"><code>FLPar(Linf=50, K=0.5, t0=-0.2, units=c(&quot;cm&quot;, &quot;1/y&quot;, &quot;y&quot;))</code></pre>
<pre><code>An object of class &quot;FLPar&quot;
params
Linf    K   t0 
50.0  0.5 -0.2 
units:  cm 1/y y </code></pre>
<p>The content of this slot can be extracted and altered, using the usual accessor and replacement methods, in this case <code>units</code> and <code>units&lt;-</code>.</p>
<pre class="r"><code>units(fq)</code></pre>
<pre><code>[1] &quot;kg&quot;</code></pre>
<pre class="r"><code>units(fq) &lt;- &quot;t&quot;

summary(fq)</code></pre>
<pre><code>An object of class &quot;FLQuant&quot; with:
dim  :  1 1 1 1 1 1 
quant:  quant 
units:  t 

Min    :  1.287 
1st Qu.:  1.287 
Mean   :  1.287 
Median :  1.287 
3rd Qu.:  1.287 
Max    :  1.287 
NAs    :  0 %</code></pre>
</div>
<div id="computable-units-of-measurement" class="section level1">
<h1>Computable units of measurement</h1>
<p>Although the content of the <code>units</code> slot is not limited in any way, and any character string is valid, the most commonly-employed units have been tabulated so that the arithmetic operators defined for the <code>FLQuant</code> and <code>FLPar</code> classes are able to operate on them and return an object with the right units.</p>
<div id="numbers" class="section level2">
<h2>Numbers</h2>
<p>Numbers of fish, e.g. catch-at-age, or any other type of count data should use one of the following ways of expressing the scale at which the data is stored when not done in direct count numbers, from tens to billions:</p>
<ul>
<li><code>10</code>, <code>100</code>, …, <code>1000000000</code></li>
<li><code>10^1</code>, <code>10^2</code>, … <code>10^9</code></li>
<li><code>1e1</code>, <code>1e2</code>, …, <code>1e9</code></li>
</ul>
<p>Any of those three notations will be understood, but the one used when returning the result of a calculation will be as follows:</p>
<ul>
<li><code>10</code>, <code>100</code>, <code>1000</code>, <code>1e4</code>, <code>1e5</code>, <code>1e6</code>, <code>1e7</code>, <code>1e8</code> and <code>1e9</code></li>
</ul>
<p>Direct counts do not need units of measurement, so <code>units</code> should be specified as an empty character vector (<code>&quot;&quot;</code> or <code>character(1)</code>).</p>
</div>
<div id="weights" class="section level2">
<h2>Weights</h2>
<p>Two units are currently recognized: <code>kg</code> and <code>t</code>, corresponding to kilogram and (metric) tonne.</p>
</div>
<div id="mortality" class="section level2">
<h2>Mortality</h2>
<p>The distinction of the various sources of, and different ways of calculating fish mortality, are traced in <strong>FLCore</strong> by assigning a particular set of units of measurement to each of those quantities. This is done despite the fact that all of them are in fact unitless.</p>
<ul>
<li>Fishing mortality: <code>f</code>, for instantaneous fishing mortality, or <code>hr</code>, for harvest rate, the proportion of biomass caught in a given time period.</li>
<li>Natural mortality: <code>m</code>, for the instantaneous mortality due to natural causes.</li>
<li>Total mortality: <code>z</code>, the sum of <code>m</code> and <code>f</code></li>
</ul>
</div>
<div id="currency" class="section level2">
<h2>Currency</h2>
<p>Objects containing economic information, such as prices of fish or costs of fishing, should use the corresponding <a href="https://en.wikipedia.org/wiki/ISO_4217">ISO 4217 currency code</a>, of which two are already present in the table used by <code>uom</code>: <code>EUR</code> for Euro, and <code>USD</code> for US Dollar.</p>
<pre class="r"><code>FLQuant(1.2e6, units=&quot;EUR&quot;)</code></pre>
<pre><code>An object of class &quot;FLQuant&quot;
An object of class &quot;FLQuant&quot;
, , unit = unique, season = all, area = unique

     year
quant 1      
  all 1200000

units:  EUR </code></pre>
</div>
<div id="time" class="section level2">
<h2>Time</h2>
<p>Quantities such as fishing effort are often measured in time. Two standard units are currently included in the table that <code>uom</code> queries: <code>d</code> for days and <code>h</code> for hours. These could be used for either time at sea or actual fishing time.</p>
</div>
<div id="missing-values" class="section level2">
<h2>Missing values</h2>
<p>If the units of measurement have not been specified, they will be <code>NA</code>, <em>not available</em>. This is what the class constructors will default to if not other value is provided.</p>
</div>
<div id="unitless-quantities" class="section level2">
<h2>Unitless quantities</h2>
<p>Multiple quantities used in fisheries science are unitless, for example proportions or ratios of other quantities. An empty string of length 1, “” or <code>character(1)</code>, will be then used.</p>
</div>
</div>
<div id="units-of-measurement-when-computing-with-flquants" class="section level1">
<h1>Units of measurement when computing with FLQuants</h1>
<p>Arithmetic operations on <code>FLQuant</code> objects will invoque the <code>uom</code> function to assign a value to the <code>units</code> slot of the returned object. This function takes three character arguments: the first for the operation being carried out, one of <code>/</code>, <code>*</code>, <code>+</code> or <code>-</code>, and the content of the <code>units</code> slot of each of the objects. For example, the addition of two objects with <code>kg</code> as units would lead to another object also with <code>kg</code> as units of measurement</p>
<pre class="r"><code>FLQuant(9230, units=&quot;kg&quot;) + FLQuant(367, units=&quot;kg&quot;)</code></pre>
<pre><code>An object of class &quot;FLQuant&quot;
An object of class &quot;FLQuant&quot;
, , unit = unique, season = all, area = unique

     year
quant 1   
  all 9597

units:  kg </code></pre>
<p>which internally is calling <code>uom</code> with the necessary arguments</p>
<pre class="r"><code>uom(&quot;+&quot;, &quot;kg&quot;, &quot;kg&quot;)</code></pre>
<pre><code>[1] &quot;kg&quot;</code></pre>
<p>The addition or substraction of two objects with the same units will return a new object that shares those units of measurement.</p>
<div id="products-of-numbers" class="section level2">
<h2>Products of numbers</h2>
<p>When multiplying objects containing counts of different scale, the <code>units</code> slot is computed by scaling it to the product of both units, for example</p>
<ul>
<li><code>10 * 1000 = 1e4</code></li>
<li><code>1e4 * 100 = 1e6</code></li>
</ul>
<pre class="r"><code>FLQuant(c(467.34, 345.33), units=&quot;1000&quot;) * FLQuant(c(2.4, 3.5), units=&quot;100&quot;)</code></pre>
<pre><code>An object of class &quot;FLQuant&quot;
An object of class &quot;FLQuant&quot;
, , unit = unique, season = all, area = unique

     year
quant 1      2     
  all 1121.6 1208.7

units:  1e5 </code></pre>
</div>
<div id="transformation-of-units" class="section level2">
<h2>Transformation of units</h2>
<p>A small number of operations have been identified that naturally lead to the units of the result being different to those of any of the input objects. Again, no transformation of values takes place, and only the content of <code>units</code> slot is altered, as in the previous examples. The existing rules are:</p>
<ul>
<li><code>1000 * kg = t</code> for any of the alllowed notations for the first quantity, and for all subsequent calculation, such as <code>t / 1000 = kg</code>.</li>
</ul>
<pre class="r"><code>FLQuant(c(467.34, 345.33), units=&quot;1000&quot;) * FLQuant(c(2.4, 3.5), units=&quot;kg&quot;)</code></pre>
<pre><code>An object of class &quot;FLQuant&quot;
An object of class &quot;FLQuant&quot;
, , unit = unique, season = all, area = unique

     year
quant 1      2     
  all 1121.6 1208.7

units:  t </code></pre>
<ul>
<li><code>f + m = z</code>, and subsequent combinations, like <code>z - m = f</code> etc.</li>
</ul>
<pre class="r"><code>FLQuant(runif(8, 0.1, 0.8), units=&quot;f&quot;) %+% FLQuant(0.2, units=&quot;m&quot;)</code></pre>
<pre><code>An object of class &quot;FLQuant&quot;
An object of class &quot;FLQuant&quot;
, , unit = unique, season = all, area = unique

     year
quant 1       2       3       4       5       6       7       8      
  all 0.51475 0.35683 0.82217 0.67726 0.35724 0.45620 0.91196 0.39663

units:  z </code></pre>
</div>
<div id="products-and-division-of-composite-units" class="section level2">
<h2>Products and division of composite units</h2>
<p>Some cases in which composite units of measurement, those formed by a string showing the operation carried out, like <code>100 * kg</code> or <code>EUR / d</code> can, for certain operations, be simplified. Two possible cases exist that <code>uom</code> is able to handle. The first one is a product of a quantity with another in which the later has as units a division with the units of the first as denominator. For example, fixed costs in a fishery, expressed as a ratio of some currency per boat, <code>EUR / boat</code>, can then be multiplied by the number of boats operating per unit of time to obtain the total amount</p>
<pre class="r"><code>FLQuant(126, units=&quot;boat&quot;) * FLQuant(2350, units=&quot;EUR / boat&quot;)</code></pre>
<pre><code>An object of class &quot;FLQuant&quot;
An object of class &quot;FLQuant&quot;
, , unit = unique, season = all, area = unique

     year
quant 1     
  all 296100

units:  EUR </code></pre>
<p>This works even if the units expression of the first</p>
<pre class="r"><code>FLQuant(126, units=&quot;boat / d&quot;) * FLQuant(2350, units=&quot;EUR / boat / d&quot;)</code></pre>
<pre><code>An object of class &quot;FLQuant&quot;
An object of class &quot;FLQuant&quot;
, , unit = unique, season = all, area = unique

     year
quant 1     
  all 296100

units:  EUR </code></pre>
<pre class="r"><code>FLQuant(2350, units=&quot;EUR / boat / d&quot;) * FLQuant(2350, units=&quot;boat / d&quot;)</code></pre>
<pre><code>An object of class &quot;FLQuant&quot;
An object of class &quot;FLQuant&quot;
, , unit = unique, season = all, area = unique

     year
quant 1      
  all 5522500

units:  EUR </code></pre>
</div>
<div id="computing-ratios" class="section level2">
<h2>Computing ratios</h2>
<p>The division of any object by another with the same units of measurement will lead to an object with no units in the slot, i.e. a unitless ratio.</p>
<pre class="r"><code>FLQuant(34170, units=&quot;t&quot;) / FLQuant(2.32, units=&quot;t&quot;)</code></pre>
<pre><code>An object of class &quot;FLQuant&quot;
An object of class &quot;FLQuant&quot;
, , unit = unique, season = all, area = unique

     year
quant 1    
  all 14728

units:   </code></pre>
</div>
<div id="dealing-with-missing-units" class="section level2">
<h2>Dealing with missing units</h2>
<p>When the units of measurement in one of the objects are missing, they are “NA”, any operation will lead to an object with “NA” in the <code>units</code> slot.</p>
<pre class="r"><code>FLQuant(34170, units=&quot;t&quot;) / FLQuant(2.32, units=&quot;NA&quot;)</code></pre>
<pre><code>An object of class &quot;FLQuant&quot;
An object of class &quot;FLQuant&quot;
, , unit = unique, season = all, area = unique

     year
quant 1    
  all 14728

units:  NA </code></pre>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>L. T. Kell, I. Mosqueira, P. Grosjean, J-M. Fromentin, D. Garcia, R. Hillary, E. Jardim, S. Mardle, M. A. Pastoors, J. J. Poos, F. Scott, R. D. Scott; FLR: an open-source framework for the evaluation and development of management strategies. <em>ICES J Mar Sci</em> 2007; 64 (4): 640-646. doi: <a href="https://doi.org/10.1093/icesjms/fsm012">10.1093/icesjms/fsm012</a>.</p>
<p>Wikipedia, The Free Encyclopedia, s.v. “ISO_4217” (accessed July 13, 2017), <a href="https://en.wikipedia.org/wiki/ISO_4217" class="uri">https://en.wikipedia.org/wiki/ISO_4217</a></p>
</div>
<div id="more-information" class="section level1">
<h1>More information</h1>
<ul>
<li>You can submit bug reports, questions or suggestions on this tutorial at <a href="https://github.com/flr/doc/issues" class="uri">https://github.com/flr/doc/issues</a>.</li>
<li>Alternatively, send a pull request to <a href="https://github.com/flr/doc/" class="uri">https://github.com/flr/doc/</a>.</li>
<li>For more information on the FLR Project for Quantitative Fisheries Science in R, visit the FLR webpage: <a href="http://flr-project.org" class="uri">http://flr-project.org</a>.</li>
</ul>
<div id="software-versions" class="section level2">
<h2>Software Versions</h2>
<ul>
<li>R version 3.4.1 (2017-06-30)</li>
<li>FLCore: 2.6.3.9006</li>
<li><strong>Compiled</strong>: Fri Aug 11 16:46:09 2017</li>
</ul>
</div>
<div id="license" class="section level2">
<h2>License</h2>
<p>This document is licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0">Creative Commons Attribution-ShareAlike 4.0 International</a> license.</p>
</div>
<div id="author-information" class="section level2">
<h2>Author information</h2>
<p><strong>Iago MOSQUEIRA</strong>. European Commission, <a href="https://ec.europa.eu/jrc/">DG Joint Research Centre</a>, Directorate D - Sustainable Resources, Unit D.02 Water and Marine Resources, Via E. Fermi 2749, 21027 Ispra VA, Italy.</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
